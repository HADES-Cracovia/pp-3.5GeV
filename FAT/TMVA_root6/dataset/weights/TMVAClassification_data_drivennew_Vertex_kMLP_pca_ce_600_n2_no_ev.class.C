// Class: ReadkMLP_pca_ce_600_n2_no_ev
// Automatically generated by MethodBase::MakeClass
//

/* configuration options =====================================================

#GEN -*-*-*-*-*-*-*-*-*-*-*- general info -*-*-*-*-*-*-*-*-*-*-*-

Method         : MLP::kMLP_pca_ce_600_n2_no_ev
TMVA Release   : 4.2.1         [262657]
ROOT Release   : 6.12/06       [396294]
Creator        : knowakow
Date           : Fri Dec 20 15:03:37 2019
Host           : Linux lxbuild05 3.16.0-4-amd64 #1 SMP Debian 3.16.43-2+deb8u5 (2017-09-19) x86_64 GNU/Linux
Dir            : /lustre/hades/user/knowakow/PP/FAT/TMVA_root6
Training events: 1000
Analysis type  : [Classification]


#OPT -*-*-*-*-*-*-*-*-*-*-*-*- options -*-*-*-*-*-*-*-*-*-*-*-*-

# Set by User:
NCycles: "600" [Number of training cycles]
HiddenLayers: "N,N" [Specification of hidden layer architecture]
NeuronType: "sigmoid" [Neuron activation function type]
EstimatorType: "CE" [MSE (Mean Square Estimator) for Gaussian Likelihood or CE(Cross-Entropy) for Bernoulli Likelihood]
NeuronInputType: "sum" [Neuron input function type]
V: "False" [Verbose output (short form of "VerbosityLevel" below - overrides the latter one)]
VarTransform: "N,P" [List of variable transformations performed before training, e.g., "D_Background,P_Signal,G,N_AllClasses" for: "Decorrelation, PCA-transformation, Gaussianisation, Normalisation, each for the given class of events ('AllClasses' denotes all events of all classes, if no class indication is given, 'All' is assumed)"]
H: "False" [Print method-specific help message]
TrainingMethod: "BP" [Train with Back-Propagation (BP), BFGS Algorithm (BFGS), or Genetic Algorithm (GA - slower and worse)]
BPMode: "sequential" [Back-propagation learning mode: sequential or batch]
CalculateErrors: "True" [Calculates inverse Hessian matrix at the end of the training to be able to calculate the uncertainties of an MVA value]
# Default:
RandomSeed: "1" [Random seed for initial synapse weights (0 means unique seed for each run; default value '1')]
VerbosityLevel: "Default" [Verbosity level]
CreateMVAPdfs: "False" [Create PDFs for classifier outputs (signal and background)]
IgnoreNegWeightsInTraining: "False" [Events with negative weights are ignored in the training (but are included for testing and performance evaluation)]
LearningRate: "2.000000e-02" [ANN learning rate parameter]
DecayRate: "1.000000e-02" [Decay rate for learning parameter]
TestRate: "10" [Test for overtraining performed at each #th epochs]
EpochMonitoring: "False" [Provide epoch-wise monitoring plots according to TestRate (caution: causes big ROOT output file!)]
Sampling: "1.000000e+00" [Only 'Sampling' (randomly selected) events are trained each epoch]
SamplingEpoch: "1.000000e+00" [Sampling is used for the first 'SamplingEpoch' epochs, afterwards, all events are taken for training]
SamplingImportance: "1.000000e+00" [ The sampling weights of events in epochs which successful (worse estimator than before) are multiplied with SamplingImportance, else they are divided.]
SamplingTraining: "True" [The training sample is sampled]
SamplingTesting: "False" [The testing sample is sampled]
ResetStep: "50" [How often BFGS should reset history]
Tau: "3.000000e+00" [LineSearch "size step"]
BatchSize: "-1" [Batch size: number of events/batch, only set if in Batch Mode, -1 for BatchSize=number_of_events]
ConvergenceImprove: "1.000000e-30" [Minimum improvement which counts as improvement (<0 means automatic convergence check is turned off)]
ConvergenceTests: "-1" [Number of steps (without improvement) required for convergence (<0 means automatic convergence check is turned off)]
UseRegulator: "False" [Use regulator to avoid over-training]
UpdateLimit: "10000" [Maximum times of regulator update]
WeightRange: "1.000000e+00" [Take the events for the estimator calculations from small deviations from the desired value to large deviations only over the weight range]
##


#VAR -*-*-*-*-*-*-*-*-*-*-*-* variables *-*-*-*-*-*-*-*-*-*-*-*-

NVar 11
dist_p_pim                    dist_p_pim                    dist_p_pim                    dist_p_pim                    mm                                'F'    [0.00962589960545,360.370452881]
dist_pip_pim                  dist_pip_pim                  dist_pip_pim                  dist_pip_pim                  mm                                'F'    [0.0102627258748,210.590133667]
ver_pip_pim_x                 ver_pip_pim_x                 ver_pip_pim_x                 ver_pip_pim_x                 mm                                'F'    [-892.634399414,234.761169434]
ver_pip_pim_y                 ver_pip_pim_y                 ver_pip_pim_y                 ver_pip_pim_y                 mm                                'F'    [-680.192504883,318.710021973]
ver_pip_pim_z                 ver_pip_pim_z                 ver_pip_pim_z                 ver_pip_pim_z                 mm                                'F'    [-1678.53918457,2130.63037109]
ver_p_pim_x                   ver_p_pim_x                   ver_p_pim_x                   ver_p_pim_x                   mm                                'F'    [-498.919464111,292.15838623]
ver_p_pim_y                   ver_p_pim_y                   ver_p_pim_y                   ver_p_pim_y                   mm                                'F'    [-238.41078186,394.70803833]
ver_p_pim_z                   ver_p_pim_z                   ver_p_pim_z                   ver_p_pim_z                   mm                                'F'    [-679.324584961,1315.92700195]
oa_lambda                     oa_lambda                     oa_lambda                     oa_lambda                     deg                               'F'    [0.254244267941,179.524276733]
dist_lambda_ver_pip_pim       dist_lambda_ver_pip_pim       dist_lambda_ver_pip_pim       dist_lambda_ver_pip_pim       mm                                'F'    [0.0999284461141,1060.86950684]
dist_ver_to_ver               dist_ver_to_ver               dist_ver_to_ver               dist_ver_to_ver               mm                                'F'    [0.404500573874,2527.47607422]
NSpec 0


============================================================================ */

#include <array>
#include <vector>
#include <cmath>
#include <string>
#include <iostream>

#ifndef IClassifierReader__def
#define IClassifierReader__def

class IClassifierReader {

 public:

   // constructor
   IClassifierReader() : fStatusIsClean( true ) {}
   virtual ~IClassifierReader() {}

   // return classifier response
   virtual double GetMvaValue( const std::vector<double>& inputValues ) const = 0;

   // returns classifier status
   bool IsStatusClean() const { return fStatusIsClean; }

 protected:

   bool fStatusIsClean;
};

#endif

class ReadkMLP_pca_ce_600_n2_no_ev : public IClassifierReader {

 public:

   // constructor
   ReadkMLP_pca_ce_600_n2_no_ev( std::vector<std::string>& theInputVars ) 
      : IClassifierReader(),
        fClassName( "ReadkMLP_pca_ce_600_n2_no_ev" ),
        fNvars( 11 ),
        fIsNormalised( false )
   {      
      // the training input variables
      const char* inputVars[] = { "dist_p_pim", "dist_pip_pim", "ver_pip_pim_x", "ver_pip_pim_y", "ver_pip_pim_z", "ver_p_pim_x", "ver_p_pim_y", "ver_p_pim_z", "oa_lambda", "dist_lambda_ver_pip_pim", "dist_ver_to_ver" };

      // sanity checks
      if (theInputVars.size() <= 0) {
         std::cout << "Problem in class \"" << fClassName << "\": empty input vector" << std::endl;
         fStatusIsClean = false;
      }

      if (theInputVars.size() != fNvars) {
         std::cout << "Problem in class \"" << fClassName << "\": mismatch in number of input values: "
                   << theInputVars.size() << " != " << fNvars << std::endl;
         fStatusIsClean = false;
      }

      // validate input variables
      for (size_t ivar = 0; ivar < theInputVars.size(); ivar++) {
         if (theInputVars[ivar] != inputVars[ivar]) {
            std::cout << "Problem in class \"" << fClassName << "\": mismatch in input variable names" << std::endl
                      << " for variable [" << ivar << "]: " << theInputVars[ivar].c_str() << " != " << inputVars[ivar] << std::endl;
            fStatusIsClean = false;
         }
      }

      // initialize min and max vectors (for normalisation)
      fVmin[0] = -1.09238004684448;
      fVmax[0] = 0.957520365715027;
      fVmin[1] = -0.162159532308578;
      fVmax[1] = 2.24265575408936;
      fVmin[2] = -0.534303903579712;
      fVmax[2] = 1.80356049537659;
      fVmin[3] = -1.40060865879059;
      fVmax[3] = 1.24824154376984;
      fVmin[4] = -1.20988011360168;
      fVmax[4] = 0.9604811668396;
      fVmin[5] = -1.9087690114975;
      fVmax[5] = 1.24597883224487;
      fVmin[6] = -1.29834342002869;
      fVmax[6] = 0.788011908531189;
      fVmin[7] = -0.549411714076996;
      fVmax[7] = 0.717999458312988;
      fVmin[8] = -0.563828229904175;
      fVmax[8] = 0.840017080307007;
      fVmin[9] = -0.220414131879807;
      fVmax[9] = 1.16971516609192;
      fVmin[10] = -0.243975624442101;
      fVmax[10] = 0.404572069644928;

      // initialize input variable types
      fType[0] = 'F';
      fType[1] = 'F';
      fType[2] = 'F';
      fType[3] = 'F';
      fType[4] = 'F';
      fType[5] = 'F';
      fType[6] = 'F';
      fType[7] = 'F';
      fType[8] = 'F';
      fType[9] = 'F';
      fType[10] = 'F';

      // initialize constants
      Initialize();

      // initialize transformation
      InitTransform();
   }

   // destructor
   virtual ~ReadkMLP_pca_ce_600_n2_no_ev() {
      Clear(); // method-specific
   }

   // the classifier response
   // "inputValues" is a vector of input values in the same order as the 
   // variables given to the constructor
   double GetMvaValue( const std::vector<double>& inputValues ) const;

 private:

   // method-specific destructor
   void Clear();

   // input variable transformation

   double fMin_1[3][11];
   double fMax_1[3][11];

   void X2P_2( const double*, double*, int ) const;
   double fMeanValues_2[3][11];
   double fEigenVectors_2[3][11][11];

   void InitTransform_1();
   void Transform_1( std::vector<double> & iv, int sigOrBgd ) const;
   void InitTransform_2();
   void Transform_2( std::vector<double> & iv, int sigOrBgd ) const;
   void InitTransform();
   void Transform( std::vector<double> & iv, int sigOrBgd ) const;

   // common member variables
   const char* fClassName;

   const size_t fNvars;
   size_t GetNvar()           const { return fNvars; }
   char   GetType( int ivar ) const { return fType[ivar]; }

   // normalisation of input variables
   const bool fIsNormalised;
   bool IsNormalised() const { return fIsNormalised; }
   double fVmin[11];
   double fVmax[11];
   double NormVariable( double x, double xmin, double xmax ) const {
      // normalise to output range: [-1, 1]
      return 2*(x - xmin)/(xmax - xmin) - 1.0;
   }

   // type of input variable: 'F' or 'I'
   char   fType[11];

   // initialize internal variables
   void Initialize();
   double GetMvaValue__( const std::vector<double>& inputValues ) const;

   // private members (method specific)

   double ActivationFnc(double x) const;
   double OutputActivationFnc(double x) const;

   int fLayers;
   int fLayerSize[4];
   double fWeightMatrix0to1[12][12];   // weight matrix from layer 0 to 1
   double fWeightMatrix1to2[12][12];   // weight matrix from layer 1 to 2
   double fWeightMatrix2to3[1][12];   // weight matrix from layer 2 to 3

};

inline void ReadkMLP_pca_ce_600_n2_no_ev::Initialize()
{
   // build network structure
   fLayers = 4;
   fLayerSize[0] = 12;
   fLayerSize[1] = 12;
   fLayerSize[2] = 12;
   fLayerSize[3] = 1;
   // weight matrix from layer 0 to 1
   fWeightMatrix0to1[0][0] = -0.502627950141286;
   fWeightMatrix0to1[1][0] = 1.80892164438757;
   fWeightMatrix0to1[2][0] = 1.19521494103444;
   fWeightMatrix0to1[3][0] = 1.74846479240449;
   fWeightMatrix0to1[4][0] = -2.5382735172468;
   fWeightMatrix0to1[5][0] = -1.50125465061307;
   fWeightMatrix0to1[6][0] = -0.769353104860013;
   fWeightMatrix0to1[7][0] = 1.71695413593421;
   fWeightMatrix0to1[8][0] = -1.43236208506716;
   fWeightMatrix0to1[9][0] = -0.87428597124048;
   fWeightMatrix0to1[10][0] = -1.84716775215604;
   fWeightMatrix0to1[0][1] = 0.469255609903668;
   fWeightMatrix0to1[1][1] = -1.08174259434473;
   fWeightMatrix0to1[2][1] = -0.646924120267285;
   fWeightMatrix0to1[3][1] = -0.859384246531803;
   fWeightMatrix0to1[4][1] = 0.458598390715532;
   fWeightMatrix0to1[5][1] = -0.241419363688797;
   fWeightMatrix0to1[6][1] = 1.88036954452113;
   fWeightMatrix0to1[7][1] = -0.0305091919311066;
   fWeightMatrix0to1[8][1] = 1.01872491834141;
   fWeightMatrix0to1[9][1] = -0.503139168093931;
   fWeightMatrix0to1[10][1] = -0.666051962305951;
   fWeightMatrix0to1[0][2] = 1.59285234072255;
   fWeightMatrix0to1[1][2] = 0.0833850263028002;
   fWeightMatrix0to1[2][2] = -1.12410452985297;
   fWeightMatrix0to1[3][2] = -0.28695154833943;
   fWeightMatrix0to1[4][2] = 1.24313629660306;
   fWeightMatrix0to1[5][2] = -1.0516448632888;
   fWeightMatrix0to1[6][2] = -1.86616910188809;
   fWeightMatrix0to1[7][2] = -0.0407943200746275;
   fWeightMatrix0to1[8][2] = 0.38649638929317;
   fWeightMatrix0to1[9][2] = 1.58935610540366;
   fWeightMatrix0to1[10][2] = -0.0758758171387253;
   fWeightMatrix0to1[0][3] = -0.535762751040159;
   fWeightMatrix0to1[1][3] = 0.442327060381897;
   fWeightMatrix0to1[2][3] = -0.0487978451198733;
   fWeightMatrix0to1[3][3] = -1.20726746422004;
   fWeightMatrix0to1[4][3] = 1.4097790187238;
   fWeightMatrix0to1[5][3] = -1.30541940410412;
   fWeightMatrix0to1[6][3] = 0.973663173417351;
   fWeightMatrix0to1[7][3] = 1.12776511847578;
   fWeightMatrix0to1[8][3] = 0.74465047441013;
   fWeightMatrix0to1[9][3] = 1.97500930625396;
   fWeightMatrix0to1[10][3] = 1.093690036554;
   fWeightMatrix0to1[0][4] = -0.329825586479853;
   fWeightMatrix0to1[1][4] = -1.65038493873292;
   fWeightMatrix0to1[2][4] = 0.742437026284256;
   fWeightMatrix0to1[3][4] = 0.207252861922205;
   fWeightMatrix0to1[4][4] = 1.17228592783902;
   fWeightMatrix0to1[5][4] = 1.50308664203235;
   fWeightMatrix0to1[6][4] = 1.56488064024709;
   fWeightMatrix0to1[7][4] = 1.36868821267284;
   fWeightMatrix0to1[8][4] = -1.5873613812539;
   fWeightMatrix0to1[9][4] = 1.00059424326117;
   fWeightMatrix0to1[10][4] = -1.79388778465029;
   fWeightMatrix0to1[0][5] = -1.66443093580939;
   fWeightMatrix0to1[1][5] = -1.38788060626563;
   fWeightMatrix0to1[2][5] = -1.65712721649008;
   fWeightMatrix0to1[3][5] = 1.62319055501505;
   fWeightMatrix0to1[4][5] = 1.16085597151195;
   fWeightMatrix0to1[5][5] = -1.71535767667405;
   fWeightMatrix0to1[6][5] = 0.292028580249314;
   fWeightMatrix0to1[7][5] = -0.181362204908665;
   fWeightMatrix0to1[8][5] = 0.895559936535395;
   fWeightMatrix0to1[9][5] = 2.06552206678778;
   fWeightMatrix0to1[10][5] = -0.352486292268764;
   fWeightMatrix0to1[0][6] = -1.67865332331305;
   fWeightMatrix0to1[1][6] = -1.32503805293907;
   fWeightMatrix0to1[2][6] = 1.01384907786886;
   fWeightMatrix0to1[3][6] = -0.624657874821138;
   fWeightMatrix0to1[4][6] = -0.103546435578567;
   fWeightMatrix0to1[5][6] = -1.52595388121492;
   fWeightMatrix0to1[6][6] = 0.642132549674932;
   fWeightMatrix0to1[7][6] = 1.23585511241799;
   fWeightMatrix0to1[8][6] = 1.60504808590194;
   fWeightMatrix0to1[9][6] = -0.00575934647847872;
   fWeightMatrix0to1[10][6] = -2.03361698007924;
   fWeightMatrix0to1[0][7] = -1.00178052966634;
   fWeightMatrix0to1[1][7] = 1.18393032016188;
   fWeightMatrix0to1[2][7] = 0.564912140626212;
   fWeightMatrix0to1[3][7] = 2.07485205838347;
   fWeightMatrix0to1[4][7] = 0.127036065264253;
   fWeightMatrix0to1[5][7] = 0.993924713537401;
   fWeightMatrix0to1[6][7] = -0.786033487802808;
   fWeightMatrix0to1[7][7] = -0.924184215087009;
   fWeightMatrix0to1[8][7] = -0.64818083051197;
   fWeightMatrix0to1[9][7] = 0.896580400057655;
   fWeightMatrix0to1[10][7] = -1.14228894377916;
   fWeightMatrix0to1[0][8] = -1.94259048175338;
   fWeightMatrix0to1[1][8] = -1.79098087057798;
   fWeightMatrix0to1[2][8] = -0.231911734945805;
   fWeightMatrix0to1[3][8] = -0.168076241665907;
   fWeightMatrix0to1[4][8] = 1.81586325981538;
   fWeightMatrix0to1[5][8] = -1.55691489405898;
   fWeightMatrix0to1[6][8] = -0.801633609717437;
   fWeightMatrix0to1[7][8] = 1.68361744829581;
   fWeightMatrix0to1[8][8] = -0.67588297729847;
   fWeightMatrix0to1[9][8] = -1.50476938121037;
   fWeightMatrix0to1[10][8] = -1.45873706565233;
   fWeightMatrix0to1[0][9] = 0.575242477897561;
   fWeightMatrix0to1[1][9] = -1.99978150218905;
   fWeightMatrix0to1[2][9] = -1.91341614110924;
   fWeightMatrix0to1[3][9] = 0.510585299099317;
   fWeightMatrix0to1[4][9] = 1.75617273474581;
   fWeightMatrix0to1[5][9] = -1.0682205115086;
   fWeightMatrix0to1[6][9] = 1.71050859235104;
   fWeightMatrix0to1[7][9] = -0.921219194896272;
   fWeightMatrix0to1[8][9] = -0.74582673059177;
   fWeightMatrix0to1[9][9] = -0.0343939136485155;
   fWeightMatrix0to1[10][9] = 0.497041376871139;
   fWeightMatrix0to1[0][10] = -1.78647780169812;
   fWeightMatrix0to1[1][10] = 0.27014188862145;
   fWeightMatrix0to1[2][10] = 0.243552773945446;
   fWeightMatrix0to1[3][10] = 0.497739444612616;
   fWeightMatrix0to1[4][10] = -1.39414519255797;
   fWeightMatrix0to1[5][10] = 1.82714334145498;
   fWeightMatrix0to1[6][10] = 0.372491597082497;
   fWeightMatrix0to1[7][10] = -0.977954282076008;
   fWeightMatrix0to1[8][10] = 0.722497675269128;
   fWeightMatrix0to1[9][10] = -1.09078246573485;
   fWeightMatrix0to1[10][10] = -1.59552915998836;
   fWeightMatrix0to1[0][11] = -0.425847546685994;
   fWeightMatrix0to1[1][11] = -0.165370901962352;
   fWeightMatrix0to1[2][11] = 1.71605702656065;
   fWeightMatrix0to1[3][11] = 1.25145081595861;
   fWeightMatrix0to1[4][11] = 1.33144042650139;
   fWeightMatrix0to1[5][11] = -0.526468098381925;
   fWeightMatrix0to1[6][11] = -0.16505768422425;
   fWeightMatrix0to1[7][11] = -2.03798892716034;
   fWeightMatrix0to1[8][11] = 0.720033506325436;
   fWeightMatrix0to1[9][11] = 0.364806220454665;
   fWeightMatrix0to1[10][11] = -1.80943681341262;
   // weight matrix from layer 1 to 2
   fWeightMatrix1to2[0][0] = 0.707595198515851;
   fWeightMatrix1to2[1][0] = -1.55437798311181;
   fWeightMatrix1to2[2][0] = -0.033606304222018;
   fWeightMatrix1to2[3][0] = 1.59127690591334;
   fWeightMatrix1to2[4][0] = 2.01874710762408;
   fWeightMatrix1to2[5][0] = -1.95776722295338;
   fWeightMatrix1to2[6][0] = 0.337152344416453;
   fWeightMatrix1to2[7][0] = 1.67171032027906;
   fWeightMatrix1to2[8][0] = 1.80351520892522;
   fWeightMatrix1to2[9][0] = 0.0287480560359504;
   fWeightMatrix1to2[10][0] = -1.64112572419967;
   fWeightMatrix1to2[0][1] = -0.0902532177010785;
   fWeightMatrix1to2[1][1] = -1.50894280057225;
   fWeightMatrix1to2[2][1] = 1.98603157895411;
   fWeightMatrix1to2[3][1] = 1.7680104098077;
   fWeightMatrix1to2[4][1] = -0.396701206903128;
   fWeightMatrix1to2[5][1] = -0.518642497430731;
   fWeightMatrix1to2[6][1] = 0.0895167387873785;
   fWeightMatrix1to2[7][1] = -1.33484617952428;
   fWeightMatrix1to2[8][1] = 0.939473842391847;
   fWeightMatrix1to2[9][1] = 1.56312795898153;
   fWeightMatrix1to2[10][1] = -0.682379058661404;
   fWeightMatrix1to2[0][2] = -1.13425491373737;
   fWeightMatrix1to2[1][2] = 0.428814106192153;
   fWeightMatrix1to2[2][2] = 2.17682772112542;
   fWeightMatrix1to2[3][2] = 0.322035263471843;
   fWeightMatrix1to2[4][2] = 0.701114282469894;
   fWeightMatrix1to2[5][2] = -1.62785936080999;
   fWeightMatrix1to2[6][2] = 1.49527237882474;
   fWeightMatrix1to2[7][2] = 0.558408223295318;
   fWeightMatrix1to2[8][2] = 0.118262326583374;
   fWeightMatrix1to2[9][2] = 0.361621303886573;
   fWeightMatrix1to2[10][2] = 1.01604225122732;
   fWeightMatrix1to2[0][3] = -0.798658588145704;
   fWeightMatrix1to2[1][3] = -0.621083928176338;
   fWeightMatrix1to2[2][3] = 1.64505675810625;
   fWeightMatrix1to2[3][3] = -0.9575369657673;
   fWeightMatrix1to2[4][3] = -0.724173691442244;
   fWeightMatrix1to2[5][3] = 1.41404817591922;
   fWeightMatrix1to2[6][3] = 0.964508617929077;
   fWeightMatrix1to2[7][3] = -0.439801535552238;
   fWeightMatrix1to2[8][3] = 1.51661893995602;
   fWeightMatrix1to2[9][3] = 1.62819647392537;
   fWeightMatrix1to2[10][3] = -2.16700781048085;
   fWeightMatrix1to2[0][4] = 0.363089401617981;
   fWeightMatrix1to2[1][4] = -0.0820104619438609;
   fWeightMatrix1to2[2][4] = 0.660276367304223;
   fWeightMatrix1to2[3][4] = -1.70044670406181;
   fWeightMatrix1to2[4][4] = -1.41022316819687;
   fWeightMatrix1to2[5][4] = 0.993178241468893;
   fWeightMatrix1to2[6][4] = 1.78597249362442;
   fWeightMatrix1to2[7][4] = -1.64848912611202;
   fWeightMatrix1to2[8][4] = -0.0806846676055813;
   fWeightMatrix1to2[9][4] = -0.756686388050374;
   fWeightMatrix1to2[10][4] = 0.140710690307297;
   fWeightMatrix1to2[0][5] = 1.88874102946295;
   fWeightMatrix1to2[1][5] = -0.588376689454878;
   fWeightMatrix1to2[2][5] = -0.639128582413124;
   fWeightMatrix1to2[3][5] = -0.739040297617747;
   fWeightMatrix1to2[4][5] = 1.44859743147137;
   fWeightMatrix1to2[5][5] = 1.4654054965514;
   fWeightMatrix1to2[6][5] = 1.06526248905202;
   fWeightMatrix1to2[7][5] = 0.553604226346408;
   fWeightMatrix1to2[8][5] = -0.219835307503636;
   fWeightMatrix1to2[9][5] = -2.11970684260413;
   fWeightMatrix1to2[10][5] = 0.835325640279022;
   fWeightMatrix1to2[0][6] = 0.230765166181566;
   fWeightMatrix1to2[1][6] = -1.36733949319252;
   fWeightMatrix1to2[2][6] = -0.369706950207798;
   fWeightMatrix1to2[3][6] = 0.292119748232277;
   fWeightMatrix1to2[4][6] = 0.138980945385843;
   fWeightMatrix1to2[5][6] = -2.0177271688141;
   fWeightMatrix1to2[6][6] = 1.52547195990939;
   fWeightMatrix1to2[7][6] = 0.803131835581026;
   fWeightMatrix1to2[8][6] = -0.852135854079631;
   fWeightMatrix1to2[9][6] = -0.234603784882133;
   fWeightMatrix1to2[10][6] = 1.64208003696714;
   fWeightMatrix1to2[0][7] = 0.888445681046105;
   fWeightMatrix1to2[1][7] = 0.547192587434537;
   fWeightMatrix1to2[2][7] = 0.0213531928203485;
   fWeightMatrix1to2[3][7] = -1.9709946579193;
   fWeightMatrix1to2[4][7] = -0.891362394927922;
   fWeightMatrix1to2[5][7] = 1.68313263395199;
   fWeightMatrix1to2[6][7] = 1.30008159929088;
   fWeightMatrix1to2[7][7] = 0.751444403049317;
   fWeightMatrix1to2[8][7] = 0.0204868949102062;
   fWeightMatrix1to2[9][7] = 1.95638147057386;
   fWeightMatrix1to2[10][7] = -1.68250996046028;
   fWeightMatrix1to2[0][8] = -1.79086040536204;
   fWeightMatrix1to2[1][8] = 0.0797442219760737;
   fWeightMatrix1to2[2][8] = -0.564907407445234;
   fWeightMatrix1to2[3][8] = 0.82023537463481;
   fWeightMatrix1to2[4][8] = 1.39734683845409;
   fWeightMatrix1to2[5][8] = -1.29059141185844;
   fWeightMatrix1to2[6][8] = 0.789891159202703;
   fWeightMatrix1to2[7][8] = -0.343070596494334;
   fWeightMatrix1to2[8][8] = -2.28832861437732;
   fWeightMatrix1to2[9][8] = -1.21610868280071;
   fWeightMatrix1to2[10][8] = 1.1014119448814;
   fWeightMatrix1to2[0][9] = -0.175885407593133;
   fWeightMatrix1to2[1][9] = 0.993079098958262;
   fWeightMatrix1to2[2][9] = -0.865841801368931;
   fWeightMatrix1to2[3][9] = 1.84462270955968;
   fWeightMatrix1to2[4][9] = -1.7581245520265;
   fWeightMatrix1to2[5][9] = 0.733344788868765;
   fWeightMatrix1to2[6][9] = 0.0580728607220788;
   fWeightMatrix1to2[7][9] = -1.50524139622365;
   fWeightMatrix1to2[8][9] = -1.08880279223036;
   fWeightMatrix1to2[9][9] = -2.08460130927356;
   fWeightMatrix1to2[10][9] = -0.531617338602439;
   fWeightMatrix1to2[0][10] = -1.84766673401979;
   fWeightMatrix1to2[1][10] = -1.62077273861623;
   fWeightMatrix1to2[2][10] = -2.10728138868649;
   fWeightMatrix1to2[3][10] = 0.282316015078735;
   fWeightMatrix1to2[4][10] = -0.851982866203094;
   fWeightMatrix1to2[5][10] = -1.62170403634418;
   fWeightMatrix1to2[6][10] = 1.43073933673421;
   fWeightMatrix1to2[7][10] = -0.738330056167378;
   fWeightMatrix1to2[8][10] = 0.269072429534917;
   fWeightMatrix1to2[9][10] = -1.10757336378115;
   fWeightMatrix1to2[10][10] = 0.212099138340468;
   fWeightMatrix1to2[0][11] = 1.41004047129148;
   fWeightMatrix1to2[1][11] = 1.41707090591176;
   fWeightMatrix1to2[2][11] = -0.130638605747616;
   fWeightMatrix1to2[3][11] = -1.49210508142715;
   fWeightMatrix1to2[4][11] = -1.13079794306674;
   fWeightMatrix1to2[5][11] = -1.06482402717962;
   fWeightMatrix1to2[6][11] = -1.67524111950554;
   fWeightMatrix1to2[7][11] = 0.250502575872153;
   fWeightMatrix1to2[8][11] = -0.00408398483453783;
   fWeightMatrix1to2[9][11] = 1.61710803319005;
   fWeightMatrix1to2[10][11] = -0.438673574822454;
   // weight matrix from layer 2 to 3
   fWeightMatrix2to3[0][0] = 1.34081729412927;
   fWeightMatrix2to3[0][1] = -1.08171298495562;
   fWeightMatrix2to3[0][2] = -1.93093797791294;
   fWeightMatrix2to3[0][3] = 1.36430265329741;
   fWeightMatrix2to3[0][4] = 0.948316439082899;
   fWeightMatrix2to3[0][5] = -0.197715737236064;
   fWeightMatrix2to3[0][6] = -0.217756744531879;
   fWeightMatrix2to3[0][7] = 0.62273164603469;
   fWeightMatrix2to3[0][8] = 1.7914918858382;
   fWeightMatrix2to3[0][9] = -0.363374919430722;
   fWeightMatrix2to3[0][10] = -0.844646882954158;
   fWeightMatrix2to3[0][11] = 0.50876817613356;
}

inline double ReadkMLP_pca_ce_600_n2_no_ev::GetMvaValue__( const std::vector<double>& inputValues ) const
{
   if (inputValues.size() != (unsigned int)fLayerSize[0]-1) {
      std::cout << "Input vector needs to be of size " << fLayerSize[0]-1 << std::endl;
      return 0;
   }

   std::array<double, 12> fWeights0 {{}};
   std::array<double, 12> fWeights1 {{}};
   std::array<double, 12> fWeights2 {{}};
   std::array<double, 1> fWeights3 {{}};
   fWeights0.back() = 1.;
   fWeights1.back() = 1.;
   fWeights2.back() = 1.;

   for (int i=0; i<fLayerSize[0]-1; i++)
      fWeights0[i]=inputValues[i];

   // layer 0 to 1
   for (int o=0; o<fLayerSize[1]-1; o++) {
      for (int i=0; i<fLayerSize[0]; i++) {
         double inputVal = fWeightMatrix0to1[o][i] * fWeights0[i];
         fWeights1[o] += inputVal;
      } // loop over i
      fWeights1[o] = ActivationFnc(fWeights1[o]);
   } // loop over o
   // layer 1 to 2
   for (int o=0; o<fLayerSize[2]-1; o++) {
      for (int i=0; i<fLayerSize[1]; i++) {
         double inputVal = fWeightMatrix1to2[o][i] * fWeights1[i];
         fWeights2[o] += inputVal;
      } // loop over i
      fWeights2[o] = ActivationFnc(fWeights2[o]);
   } // loop over o
   // layer 2 to 3
   for (int o=0; o<fLayerSize[3]; o++) {
      for (int i=0; i<fLayerSize[2]; i++) {
         double inputVal = fWeightMatrix2to3[o][i] * fWeights2[i];
         fWeights3[o] += inputVal;
      } // loop over i
      fWeights3[o] = OutputActivationFnc(fWeights3[o]);
   } // loop over o

   return fWeights3[0];
}

double ReadkMLP_pca_ce_600_n2_no_ev::ActivationFnc(double x) const {
   // sigmoid
   return 1.0/(1.0+exp(-x));
}
double ReadkMLP_pca_ce_600_n2_no_ev::OutputActivationFnc(double x) const {
   // sigmoid
   return 1.0/(1.0+exp(-x));
}
   
// Clean up
inline void ReadkMLP_pca_ce_600_n2_no_ev::Clear() 
{
}
   inline double ReadkMLP_pca_ce_600_n2_no_ev::GetMvaValue( const std::vector<double>& inputValues ) const
   {
      // classifier response value
      double retval = 0;

      // classifier response, sanity check first
      if (!IsStatusClean()) {
         std::cout << "Problem in class \"" << fClassName << "\": cannot return classifier response"
                   << " because status is dirty" << std::endl;
         retval = 0;
      }
      else {
         if (IsNormalised()) {
            // normalise variables
            std::vector<double> iV;
            iV.reserve(inputValues.size());
            int ivar = 0;
            for (std::vector<double>::const_iterator varIt = inputValues.begin();
                 varIt != inputValues.end(); varIt++, ivar++) {
               iV.push_back(NormVariable( *varIt, fVmin[ivar], fVmax[ivar] ));
            }
            Transform( iV, -1 );
            retval = GetMvaValue__( iV );
         }
         else {
            std::vector<double> iV;
            int ivar = 0;
            for (std::vector<double>::const_iterator varIt = inputValues.begin();
                 varIt != inputValues.end(); varIt++, ivar++) {
               iV.push_back(*varIt);
            }
            Transform( iV, -1 );
            retval = GetMvaValue__( iV );
         }
      }

      return retval;
   }

//_______________________________________________________________________
inline void ReadkMLP_pca_ce_600_n2_no_ev::InitTransform_1()
{
   // Normalization transformation, initialisation
   fMin_1[0][0] = 0.00962589960545;
   fMax_1[0][0] = 360.370452881;
   fMin_1[1][0] = 0.0123143000528;
   fMax_1[1][0] = 268.910308838;
   fMin_1[2][0] = 0.00962589960545;
   fMax_1[2][0] = 360.370452881;
   fMin_1[0][1] = 0.0102627258748;
   fMax_1[0][1] = 210.590133667;
   fMin_1[1][1] = 0.0106324125081;
   fMax_1[1][1] = 181.226852417;
   fMin_1[2][1] = 0.0102627258748;
   fMax_1[2][1] = 210.590133667;
   fMin_1[0][2] = -892.634399414;
   fMax_1[0][2] = 234.761169434;
   fMin_1[1][2] = -360.321136475;
   fMax_1[1][2] = 172.149917603;
   fMin_1[2][2] = -892.634399414;
   fMax_1[2][2] = 234.761169434;
   fMin_1[0][3] = -680.192504883;
   fMax_1[0][3] = 318.710021973;
   fMin_1[1][3] = -343.842803955;
   fMax_1[1][3] = 297.288146973;
   fMin_1[2][3] = -680.192504883;
   fMax_1[2][3] = 318.710021973;
   fMin_1[0][4] = -1678.53918457;
   fMax_1[0][4] = 2130.63037109;
   fMin_1[1][4] = -595.948669434;
   fMax_1[1][4] = 762.634094238;
   fMin_1[2][4] = -1678.53918457;
   fMax_1[2][4] = 2130.63037109;
   fMin_1[0][5] = -498.919464111;
   fMax_1[0][5] = 262.806121826;
   fMin_1[1][5] = -151.994766235;
   fMax_1[1][5] = 292.15838623;
   fMin_1[2][5] = -498.919464111;
   fMax_1[2][5] = 292.15838623;
   fMin_1[0][6] = -195.17880249;
   fMax_1[0][6] = 394.70803833;
   fMin_1[1][6] = -238.41078186;
   fMax_1[1][6] = 172.396438599;
   fMin_1[2][6] = -238.41078186;
   fMax_1[2][6] = 394.70803833;
   fMin_1[0][7] = -679.324584961;
   fMax_1[0][7] = 1315.92700195;
   fMin_1[1][7] = -212.772964478;
   fMax_1[1][7] = 1245.21704102;
   fMin_1[2][7] = -679.324584961;
   fMax_1[2][7] = 1315.92700195;
   fMin_1[0][8] = 0.886417210102;
   fMax_1[0][8] = 179.524276733;
   fMin_1[1][8] = 0.254244267941;
   fMax_1[1][8] = 178.776672363;
   fMin_1[2][8] = 0.254244267941;
   fMax_1[2][8] = 179.524276733;
   fMin_1[0][9] = 0.313509166241;
   fMax_1[0][9] = 1060.86950684;
   fMin_1[1][9] = 0.0999284461141;
   fMax_1[1][9] = 860.367858887;
   fMin_1[2][9] = 0.0999284461141;
   fMax_1[2][9] = 1060.86950684;
   fMin_1[0][10] = 0.404500573874;
   fMax_1[0][10] = 2527.47607422;
   fMin_1[1][10] = 1.51164758205;
   fMax_1[1][10] = 884.684020996;
   fMin_1[2][10] = 0.404500573874;
   fMax_1[2][10] = 2527.47607422;
}

//_______________________________________________________________________
inline void ReadkMLP_pca_ce_600_n2_no_ev::Transform_1( std::vector<double>& iv, int cls) const
{
   // Normalization transformation
   if (cls < 0 || cls > 2) {
   if (2 > 1 ) cls = 2;
      else cls = 2;
   }
   const int nVar = 11;

   // get indices of used variables

   // define the indices of the variables which are transformed by this transformation
   static std::vector<int> indicesGet;
   static std::vector<int> indicesPut;

   if ( indicesGet.empty() ) { 
      indicesGet.reserve(fNvars);
      indicesGet.push_back( 0);
      indicesGet.push_back( 1);
      indicesGet.push_back( 2);
      indicesGet.push_back( 3);
      indicesGet.push_back( 4);
      indicesGet.push_back( 5);
      indicesGet.push_back( 6);
      indicesGet.push_back( 7);
      indicesGet.push_back( 8);
      indicesGet.push_back( 9);
      indicesGet.push_back( 10);
   } 
   if ( indicesPut.empty() ) { 
      indicesPut.reserve(fNvars);
      indicesPut.push_back( 0);
      indicesPut.push_back( 1);
      indicesPut.push_back( 2);
      indicesPut.push_back( 3);
      indicesPut.push_back( 4);
      indicesPut.push_back( 5);
      indicesPut.push_back( 6);
      indicesPut.push_back( 7);
      indicesPut.push_back( 8);
      indicesPut.push_back( 9);
      indicesPut.push_back( 10);
   } 

   static std::vector<double> dv;
   dv.resize(nVar);
   for (int ivar=0; ivar<nVar; ivar++) dv[ivar] = iv[indicesGet.at(ivar)];
   for (int ivar=0;ivar<11;ivar++) {
      double offset = fMin_1[cls][ivar];
      double scale  = 1.0/(fMax_1[cls][ivar]-fMin_1[cls][ivar]);
      iv[indicesPut.at(ivar)] = (dv[ivar]-offset)*scale * 2 - 1;
   }
}

//_______________________________________________________________________
inline void ReadkMLP_pca_ce_600_n2_no_ev::X2P_2( const double* x, double* p, int index ) const
{
   // Calculate the principal components from the original data vector
   // x, and return it in p (function extracted from TPrincipal::X2P)
   // It's the users responsibility to make sure that both x and p are
   // of the right size (i.e., memory must be allocated for p).
   const int nVar = 11;

   for (int i = 0; i < nVar; i++) {
      p[i] = 0;
      for (int j = 0; j < nVar; j++) p[i] += (x[j] - fMeanValues_2[index][j]) * fEigenVectors_2[index][j][i];
   }
}

//_______________________________________________________________________
inline void ReadkMLP_pca_ce_600_n2_no_ev::InitTransform_2()
{
   // PCA transformation, initialisation
   // initialise vector of mean values
   fMeanValues_2[0][0] = -0.928948357344;
   fMeanValues_2[0][1] = -0.871613139629;
   fMeanValues_2[0][2] = 0.578058866978;
   fMeanValues_2[0][3] = 0.352349742174;
   fMeanValues_2[0][4] = -0.132022423148;
   fMeanValues_2[0][5] = 0.268985263824;
   fMeanValues_2[0][6] = -0.244649246693;
   fMeanValues_2[0][7] = -0.340811044812;
   fMeanValues_2[0][8] = -0.0663215432167;
   fMeanValues_2[0][9] = -0.95204612112;
   fMeanValues_2[0][10] = -0.953781409621;
   fMeanValues_2[1][0] = -0.943598340273;
   fMeanValues_2[1][1] = -0.889240320444;
   fMeanValues_2[1][2] = 0.583325667739;
   fMeanValues_2[1][3] = 0.358286038876;
   fMeanValues_2[1][4] = -0.133678673983;
   fMeanValues_2[1][5] = 0.272199761629;
   fMeanValues_2[1][6] = -0.258827272296;
   fMeanValues_2[1][7] = -0.34819269824;
   fMeanValues_2[1][8] = -0.0230299243927;
   fMeanValues_2[1][9] = -0.955843601346;
   fMeanValues_2[1][10] = -0.97256221664;
   fMeanValues_2[2][0] = -0.936273348808;
   fMeanValues_2[2][1] = -0.880426730037;
   fMeanValues_2[2][2] = 0.580692267358;
   fMeanValues_2[2][3] = 0.355317890525;
   fMeanValues_2[2][4] = -0.132850548565;
   fMeanValues_2[2][5] = 0.270592512727;
   fMeanValues_2[2][6] = -0.251738259494;
   fMeanValues_2[2][7] = -0.344501871526;
   fMeanValues_2[2][8] = -0.0446757338047;
   fMeanValues_2[2][9] = -0.953944861233;
   fMeanValues_2[2][10] = -0.96317181313;

   // initialise matrix of eigenvectors
   fEigenVectors_2[0][0][0] = -0.00400972300598;
   fEigenVectors_2[0][0][1] = 0.0945937938993;
   fEigenVectors_2[0][0][2] = 0.269362439906;
   fEigenVectors_2[0][0][3] = 0.82971562758;
   fEigenVectors_2[0][0][4] = -0.362617732202;
   fEigenVectors_2[0][0][5] = 0.115506566499;
   fEigenVectors_2[0][0][6] = -0.241072312287;
   fEigenVectors_2[0][0][7] = 0.148559968236;
   fEigenVectors_2[0][0][8] = 0.0139884199415;
   fEigenVectors_2[0][0][9] = 0.0334930445648;
   fEigenVectors_2[0][0][10] = -0.0609509568625;
   fEigenVectors_2[0][1][0] = 0.0450632401951;
   fEigenVectors_2[0][1][1] = 0.893801067741;
   fEigenVectors_2[0][1][2] = -0.378351573203;
   fEigenVectors_2[0][1][3] = -0.00289323375364;
   fEigenVectors_2[0][1][4] = -0.0516926663128;
   fEigenVectors_2[0][1][5] = -0.182307793993;
   fEigenVectors_2[0][1][6] = -0.0497656011758;
   fEigenVectors_2[0][1][7] = 0.0790377679726;
   fEigenVectors_2[0][1][8] = 0.0684388464954;
   fEigenVectors_2[0][1][9] = -0.0811994163142;
   fEigenVectors_2[0][1][10] = -0.00464797755239;
   fEigenVectors_2[0][2][0] = -0.00224011658489;
   fEigenVectors_2[0][2][1] = -0.0591116086152;
   fEigenVectors_2[0][2][2] = -0.409704547867;
   fEigenVectors_2[0][2][3] = 0.187398405792;
   fEigenVectors_2[0][2][4] = -0.297531303619;
   fEigenVectors_2[0][2][5] = 0.0383848888485;
   fEigenVectors_2[0][2][6] = 0.219470077925;
   fEigenVectors_2[0][2][7] = -0.694877291379;
   fEigenVectors_2[0][2][8] = -0.266548690575;
   fEigenVectors_2[0][2][9] = 0.315706748401;
   fEigenVectors_2[0][2][10] = 0.0422613727958;
   fEigenVectors_2[0][3][0] = -0.00525921208673;
   fEigenVectors_2[0][3][1] = -0.111095682716;
   fEigenVectors_2[0][3][2] = -0.233395951451;
   fEigenVectors_2[0][3][3] = 0.128514910072;
   fEigenVectors_2[0][3][4] = 0.212378920072;
   fEigenVectors_2[0][3][5] = 0.170910827079;
   fEigenVectors_2[0][3][6] = -0.450413725512;
   fEigenVectors_2[0][3][7] = -0.365600122523;
   fEigenVectors_2[0][3][8] = 0.455360194904;
   fEigenVectors_2[0][3][9] = -0.380263223979;
   fEigenVectors_2[0][3][10] = 0.392219353002;
   fEigenVectors_2[0][4][0] = 0.0296229178875;
   fEigenVectors_2[0][4][1] = 0.05430625059;
   fEigenVectors_2[0][4][2] = 0.111833466815;
   fEigenVectors_2[0][4][3] = -0.243662095122;
   fEigenVectors_2[0][4][4] = -0.385159202119;
   fEigenVectors_2[0][4][5] = 0.314297392074;
   fEigenVectors_2[0][4][6] = 0.0239014728299;
   fEigenVectors_2[0][4][7] = -0.248854925985;
   fEigenVectors_2[0][4][8] = 0.328629659761;
   fEigenVectors_2[0][4][9] = -0.301641808182;
   fEigenVectors_2[0][4][10] = -0.644732210328;
   fEigenVectors_2[0][5][0] = -0.0163569296585;
   fEigenVectors_2[0][5][1] = 0.00233518331925;
   fEigenVectors_2[0][5][2] = -0.0767416915662;
   fEigenVectors_2[0][5][3] = 0.127045263413;
   fEigenVectors_2[0][5][4] = 0.521802484678;
   fEigenVectors_2[0][5][5] = -0.0930218948922;
   fEigenVectors_2[0][5][6] = -0.33768547377;
   fEigenVectors_2[0][5][7] = -0.12306687889;
   fEigenVectors_2[0][5][8] = 0.165554320251;
   fEigenVectors_2[0][5][9] = 0.503690963925;
   fEigenVectors_2[0][5][10] = -0.535235041526;
   fEigenVectors_2[0][6][0] = -0.00176048008324;
   fEigenVectors_2[0][6][1] = 0.00461657864794;
   fEigenVectors_2[0][6][2] = 0.115353216907;
   fEigenVectors_2[0][6][3] = 0.302263343872;
   fEigenVectors_2[0][6][4] = 0.202960649908;
   fEigenVectors_2[0][6][5] = -0.286727187013;
   fEigenVectors_2[0][6][6] = 0.687414741392;
   fEigenVectors_2[0][6][7] = -0.101634133304;
   fEigenVectors_2[0][6][8] = 0.53487318324;
   fEigenVectors_2[0][6][9] = -0.0537205645135;
   fEigenVectors_2[0][6][10] = 0.00753950210728;
   fEigenVectors_2[0][7][0] = -0.0367678140838;
   fEigenVectors_2[0][7][1] = 0.0659145977764;
   fEigenVectors_2[0][7][2] = 0.332685661926;
   fEigenVectors_2[0][7][3] = -0.299278869092;
   fEigenVectors_2[0][7][4] = -0.404550088111;
   fEigenVectors_2[0][7][5] = -0.313653121209;
   fEigenVectors_2[0][7][6] = -0.23145041503;
   fEigenVectors_2[0][7][7] = -0.121170562889;
   fEigenVectors_2[0][7][8] = 0.399892540147;
   fEigenVectors_2[0][7][9] = 0.472067693562;
   fEigenVectors_2[0][7][10] = 0.28461060658;
   fEigenVectors_2[0][8][0] = 0.997290760537;
   fEigenVectors_2[0][8][1] = -0.049348589243;
   fEigenVectors_2[0][8][2] = 0.0156360854223;
   fEigenVectors_2[0][8][3] = 0.00508733884477;
   fEigenVectors_2[0][8][4] = 6.8355187028e-05;
   fEigenVectors_2[0][8][5] = -0.0347936288223;
   fEigenVectors_2[0][8][6] = -0.0198158598104;
   fEigenVectors_2[0][8][7] = -0.00367288810596;
   fEigenVectors_2[0][8][8] = 0.00615135767785;
   fEigenVectors_2[0][8][9] = 0.0281314671976;
   fEigenVectors_2[0][8][10] = 0.0161092882756;
   fEigenVectors_2[0][9][0] = 0.0288383084514;
   fEigenVectors_2[0][9][1] = 0.327683806752;
   fEigenVectors_2[0][9][2] = 0.285423163285;
   fEigenVectors_2[0][9][3] = -0.0588197363794;
   fEigenVectors_2[0][9][4] = 0.231448668855;
   fEigenVectors_2[0][9][5] = 0.745761195402;
   fEigenVectors_2[0][9][6] = 0.19536798869;
   fEigenVectors_2[0][9][7] = -0.07055756238;
   fEigenVectors_2[0][9][8] = 0.0440283197825;
   fEigenVectors_2[0][9][9] = 0.30845580375;
   fEigenVectors_2[0][9][10] = 0.238551436644;
   fEigenVectors_2[0][10][0] = 4.61349300199e-05;
   fEigenVectors_2[0][10][1] = 0.243315850429;
   fEigenVectors_2[0][10][2] = 0.581265413725;
   fEigenVectors_2[0][10][3] = 0.00101658794601;
   fEigenVectors_2[0][10][4] = 0.230561991742;
   fEigenVectors_2[0][10][5] = -0.278102768515;
   fEigenVectors_2[0][10][6] = -0.0953702561104;
   fEigenVectors_2[0][10][7] = -0.498083501495;
   fEigenVectors_2[0][10][8] = -0.365149219717;
   fEigenVectors_2[0][10][9] = -0.285747202971;
   fEigenVectors_2[0][10][10] = -0.0160879267649;
   fEigenVectors_2[1][0][0] = -0.00286591466882;
   fEigenVectors_2[1][0][1] = 0.0905553922621;
   fEigenVectors_2[1][0][2] = -0.742941700749;
   fEigenVectors_2[1][0][3] = -0.639282229035;
   fEigenVectors_2[1][0][4] = -0.0900170567644;
   fEigenVectors_2[1][0][5] = -0.0307467694209;
   fEigenVectors_2[1][0][6] = 0.0703375241703;
   fEigenVectors_2[1][0][7] = 0.0666053148805;
   fEigenVectors_2[1][0][8] = -0.0686243283731;
   fEigenVectors_2[1][0][9] = -0.0598067607606;
   fEigenVectors_2[1][0][10] = 0.066551872252;
   fEigenVectors_2[1][1][0] = 0.00805969145604;
   fEigenVectors_2[1][1][1] = 0.909855127079;
   fEigenVectors_2[1][1][2] = 0.324179041919;
   fEigenVectors_2[1][1][3] = -0.236366589549;
   fEigenVectors_2[1][1][4] = -0.043155761747;
   fEigenVectors_2[1][1][5] = -0.0662424276702;
   fEigenVectors_2[1][1][6] = -0.0297892051865;
   fEigenVectors_2[1][1][7] = -0.0307103297869;
   fEigenVectors_2[1][1][8] = -0.0206495001085;
   fEigenVectors_2[1][1][9] = -0.0470254924289;
   fEigenVectors_2[1][1][10] = 0.0204615331166;
   fEigenVectors_2[1][2][0] = 0.000217472071434;
   fEigenVectors_2[1][2][1] = 0.0074632078796;
   fEigenVectors_2[1][2][2] = 0.0474034431764;
   fEigenVectors_2[1][2][3] = -0.152792666715;
   fEigenVectors_2[1][2][4] = 0.0166201342037;
   fEigenVectors_2[1][2][5] = 0.761529076798;
   fEigenVectors_2[1][2][6] = -0.430696352754;
   fEigenVectors_2[1][2][7] = 0.285753672249;
   fEigenVectors_2[1][2][8] = -0.025095303948;
   fEigenVectors_2[1][2][9] = 0.10004792887;
   fEigenVectors_2[1][2][10] = -0.341108387915;
   fEigenVectors_2[1][3][0] = -0.0085594426534;
   fEigenVectors_2[1][3][1] = -0.055418550848;
   fEigenVectors_2[1][3][2] = 0.110529175298;
   fEigenVectors_2[1][3][3] = -0.103016201763;
   fEigenVectors_2[1][3][4] = -0.445897080483;
   fEigenVectors_2[1][3][5] = -0.287145511081;
   fEigenVectors_2[1][3][6] = 0.240244084034;
   fEigenVectors_2[1][3][7] = 0.42193491958;
   fEigenVectors_2[1][3][8] = 0.380835021859;
   fEigenVectors_2[1][3][9] = 0.197421733956;
   fEigenVectors_2[1][3][10] = -0.522487111459;
   fEigenVectors_2[1][4][0] = 0.0159596871366;
   fEigenVectors_2[1][4][1] = 0.0480534118011;
   fEigenVectors_2[1][4][2] = -0.140803989552;
   fEigenVectors_2[1][4][3] = 0.175366784879;
   fEigenVectors_2[1][4][4] = -0.0971213515686;
   fEigenVectors_2[1][4][5] = -0.037221497938;
   fEigenVectors_2[1][4][6] = -0.275562610725;
   fEigenVectors_2[1][4][7] = -0.0129576679767;
   fEigenVectors_2[1][4][8] = 0.405650064483;
   fEigenVectors_2[1][4][9] = -0.825261077716;
   fEigenVectors_2[1][4][10] = -0.119701351919;
   fEigenVectors_2[1][5][0] = -0.00443748768689;
   fEigenVectors_2[1][5][1] = 0.0174511707837;
   fEigenVectors_2[1][5][2] = 0.0244964606356;
   fEigenVectors_2[1][5][3] = 0.206199859227;
   fEigenVectors_2[1][5][4] = -0.345754925651;
   fEigenVectors_2[1][5][5] = -0.0139474477531;
   fEigenVectors_2[1][5][6] = 0.0504824192166;
   fEigenVectors_2[1][5][7] = 0.613732635834;
   fEigenVectors_2[1][5][8] = -0.558935457991;
   fEigenVectors_2[1][5][9] = -0.259778510134;
   fEigenVectors_2[1][5][10] = 0.278758611414;
   fEigenVectors_2[1][6][0] = 0.0102799820337;
   fEigenVectors_2[1][6][1] = -0.0418852792608;
   fEigenVectors_2[1][6][2] = 0.00256661821162;
   fEigenVectors_2[1][6][3] = -0.0876978461013;
   fEigenVectors_2[1][6][4] = 0.474779116919;
   fEigenVectors_2[1][6][5] = -0.538770521198;
   fEigenVectors_2[1][6][6] = -0.573784186614;
   fEigenVectors_2[1][6][7] = 0.345973982544;
   fEigenVectors_2[1][6][8] = -0.080073765382;
   fEigenVectors_2[1][6][9] = 0.106879048494;
   fEigenVectors_2[1][6][10] = -0.0893998485547;
   fEigenVectors_2[1][7][0] = -0.0230588199532;
   fEigenVectors_2[1][7][1] = 0.0538804137778;
   fEigenVectors_2[1][7][2] = -0.145671067321;
   fEigenVectors_2[1][7][3] = 0.166400200457;
   fEigenVectors_2[1][7][4] = -0.574032489128;
   fEigenVectors_2[1][7][5] = -0.0774776016473;
   fEigenVectors_2[1][7][6] = -0.547086462986;
   fEigenVectors_2[1][7][7] = -0.168390805608;
   fEigenVectors_2[1][7][8] = 0.185364141681;
   fEigenVectors_2[1][7][9] = 0.360042388938;
   fEigenVectors_2[1][7][10] = 0.347117530075;
   fEigenVectors_2[1][8][0] = 0.999270702242;
   fEigenVectors_2[1][8][1] = -0.0137754425827;
   fEigenVectors_2[1][8][2] = 0.00430339465594;
   fEigenVectors_2[1][8][3] = -0.00875859921367;
   fEigenVectors_2[1][8][4] = -0.0277172706617;
   fEigenVectors_2[1][8][5] = -0.000441283091186;
   fEigenVectors_2[1][8][6] = -0.00331130121732;
   fEigenVectors_2[1][8][7] = -0.00660125360063;
   fEigenVectors_2[1][8][8] = -0.00621618705511;
   fEigenVectors_2[1][8][9] = 0.0164277035211;
   fEigenVectors_2[1][8][10] = 0.0064478713027;
   fEigenVectors_2[1][9][0] = 0.0199876236359;
   fEigenVectors_2[1][9][1] = 0.355818855702;
   fEigenVectors_2[1][9][2] = -0.449298037288;
   fEigenVectors_2[1][9][3] = 0.533101522626;
   fEigenVectors_2[1][9][4] = 0.297026367759;
   fEigenVectors_2[1][9][5] = 0.130963760031;
   fEigenVectors_2[1][9][6] = 0.192614368572;
   fEigenVectors_2[1][9][7] = 0.31287858631;
   fEigenVectors_2[1][9][8] = 0.292896281314;
   fEigenVectors_2[1][9][9] = 0.233433039522;
   fEigenVectors_2[1][9][10] = 0.07923879861;
   fEigenVectors_2[1][10][0] = 0.000533833537806;
   fEigenVectors_2[1][10][1] = 0.163610767262;
   fEigenVectors_2[1][10][2] = -0.291448211684;
   fEigenVectors_2[1][10][3] = 0.329492569815;
   fEigenVectors_2[1][10][4] = -0.134289352737;
   fEigenVectors_2[1][10][5] = -0.131451024927;
   fEigenVectors_2[1][10][6] = -0.0825971560857;
   fEigenVectors_2[1][10][7] = -0.334829321192;
   fEigenVectors_2[1][10][8] = -0.495620666456;
   fEigenVectors_2[1][10][9] = 0.0295228449796;
   fEigenVectors_2[1][10][10] = -0.615602475685;
   fEigenVectors_2[2][0][0] = 0.00393672174533;
   fEigenVectors_2[2][0][1] = 0.0914964957999;
   fEigenVectors_2[2][0][2] = 0.524531613065;
   fEigenVectors_2[2][0][3] = -0.804231494097;
   fEigenVectors_2[2][0][4] = -0.198631832203;
   fEigenVectors_2[2][0][5] = 0.0233508857921;
   fEigenVectors_2[2][0][6] = 0.0614656126965;
   fEigenVectors_2[2][0][7] = -0.128075938391;
   fEigenVectors_2[2][0][8] = -0.00573859072281;
   fEigenVectors_2[2][0][9] = -0.0635755562257;
   fEigenVectors_2[2][0][10] = -0.0737228955763;
   fEigenVectors_2[2][1][0] = -0.0270176603123;
   fEigenVectors_2[2][1][1] = 0.908000420868;
   fEigenVectors_2[2][1][2] = -0.352950182839;
   fEigenVectors_2[2][1][3] = -0.100615715366;
   fEigenVectors_2[2][1][4] = -0.101844309564;
   fEigenVectors_2[2][1][5] = -0.0796859795802;
   fEigenVectors_2[2][1][6] = -0.121472046367;
   fEigenVectors_2[2][1][7] = -0.070558588252;
   fEigenVectors_2[2][1][8] = -0.0507151784522;
   fEigenVectors_2[2][1][9] = 0.0168146236559;
   fEigenVectors_2[2][1][10] = -0.0282325333443;
   fEigenVectors_2[2][2][0] = 0.000958720195289;
   fEigenVectors_2[2][2][1] = -0.0227985072457;
   fEigenVectors_2[2][2][2] = -0.267226501112;
   fEigenVectors_2[2][2][3] = -0.299093828854;
   fEigenVectors_2[2][2][4] = -0.0124060451879;
   fEigenVectors_2[2][2][5] = 0.350399264796;
   fEigenVectors_2[2][2][6] = 0.0420019297639;
   fEigenVectors_2[2][2][7] = 0.791477517746;
   fEigenVectors_2[2][2][8] = 0.28092554855;
   fEigenVectors_2[2][2][9] = 0.0349369643413;
   fEigenVectors_2[2][2][10] = 0.0856624441322;
   fEigenVectors_2[2][3][0] = 0.0065767152838;
   fEigenVectors_2[2][3][1] = -0.0824499761628;
   fEigenVectors_2[2][3][2] = -0.181882850816;
   fEigenVectors_2[2][3][3] = -0.119878789647;
   fEigenVectors_2[2][3][4] = -0.23055345054;
   fEigenVectors_2[2][3][5] = -0.248328221933;
   fEigenVectors_2[2][3][6] = 0.496078946342;
   fEigenVectors_2[2][3][7] = 0.0832472709217;
   fEigenVectors_2[2][3][8] = -0.486389570633;
   fEigenVectors_2[2][3][9] = 0.44869151419;
   fEigenVectors_2[2][3][10] = 0.374114066573;
   fEigenVectors_2[2][4][0] = -0.0231087110628;
   fEigenVectors_2[2][4][1] = 0.0517382642442;
   fEigenVectors_2[2][4][2] = 0.128618724221;
   fEigenVectors_2[2][4][3] = 0.168546186507;
   fEigenVectors_2[2][4][4] = -0.171219101802;
   fEigenVectors_2[2][4][5] = 0.456163623968;
   fEigenVectors_2[2][4][6] = 0.0302771141379;
   fEigenVectors_2[2][4][7] = 0.105218032583;
   fEigenVectors_2[2][4][8] = -0.411085698567;
   fEigenVectors_2[2][4][9] = 0.320215928775;
   fEigenVectors_2[2][4][10] = -0.656445034255;
   fEigenVectors_2[2][5][0] = 0.0106785928486;
   fEigenVectors_2[2][5][1] = 0.00848580221064;
   fEigenVectors_2[2][5][2] = -0.0467211277202;
   fEigenVectors_2[2][5][3] = 0.0335161750794;
   fEigenVectors_2[2][5][4] = -0.0352783512244;
   fEigenVectors_2[2][5][5] = -0.526588329474;
   fEigenVectors_2[2][5][6] = 0.43826325467;
   fEigenVectors_2[2][5][7] = 0.281697084706;
   fEigenVectors_2[2][5][8] = -0.00385705795126;
   fEigenVectors_2[2][5][9] = -0.439327137161;
   fEigenVectors_2[2][5][10] = -0.503504510384;
   fEigenVectors_2[2][6][0] = -0.00345036283522;
   fEigenVectors_2[2][6][1] = -0.016865254041;
   fEigenVectors_2[2][6][2] = 0.0912123460037;
   fEigenVectors_2[2][6][3] = -0.158139719236;
   fEigenVectors_2[2][6][4] = 0.511601168612;
   fEigenVectors_2[2][6][5] = -0.263384581552;
   fEigenVectors_2[2][6][6] = -0.47741228935;
   fEigenVectors_2[2][6][7] = 0.316460020723;
   fEigenVectors_2[2][6][8] = -0.552842605514;
   fEigenVectors_2[2][6][9] = -0.0356566633054;
   fEigenVectors_2[2][6][10] = 0.0171119539058;
   fEigenVectors_2[2][7][0] = 0.0305764627557;
   fEigenVectors_2[2][7][1] = 0.0526502753018;
   fEigenVectors_2[2][7][2] = 0.246955687427;
   fEigenVectors_2[2][7][3] = 0.274476725043;
   fEigenVectors_2[2][7][4] = -0.625380724519;
   fEigenVectors_2[2][7][5] = 0.0527717411422;
   fEigenVectors_2[2][7][6] = -0.233115273915;
   fEigenVectors_2[2][7][7] = 0.247550503348;
   fEigenVectors_2[2][7][8] = -0.26296737848;
   fEigenVectors_2[2][7][9] = -0.435335838401;
   fEigenVectors_2[2][7][10] = 0.302967688127;
   fEigenVectors_2[2][8][0] = -0.998506635597;
   fEigenVectors_2[2][8][1] = -0.0324157930121;
   fEigenVectors_2[2][8][2] = 0.00424619553227;
   fEigenVectors_2[2][8][3] = -0.001273444008;
   fEigenVectors_2[2][8][4] = -0.028112581799;
   fEigenVectors_2[2][8][5] = -0.020646588923;
   fEigenVectors_2[2][8][6] = -0.00686765973139;
   fEigenVectors_2[2][8][7] = 0.00791052662702;
   fEigenVectors_2[2][8][8] = 0.00421457276919;
   fEigenVectors_2[2][8][9] = -0.0180990602158;
   fEigenVectors_2[2][8][10] = 0.0155687032447;
   fEigenVectors_2[2][9][0] = -0.0244930591026;
   fEigenVectors_2[2][9][1] = 0.337057037431;
   fEigenVectors_2[2][9][2] = 0.401201133128;
   fEigenVectors_2[2][9][3] = 0.213435352262;
   fEigenVectors_2[2][9][4] = 0.456662271907;
   fEigenVectors_2[2][9][5] = 0.31854971257;
   fEigenVectors_2[2][9][6] = 0.496052353226;
   fEigenVectors_2[2][9][7] = 0.0797964170343;
   fEigenVectors_2[2][9][8] = -0.0961231737569;
   fEigenVectors_2[2][9][9] = -0.194660165468;
   fEigenVectors_2[2][9][10] = 0.2639955396;
   fEigenVectors_2[2][10][0] = 0.000307732196759;
   fEigenVectors_2[2][10][1] = 0.198449694458;
   fEigenVectors_2[2][10][2] = 0.496778177862;
   fEigenVectors_2[2][10][3] = 0.252640205499;
   fEigenVectors_2[2][10][4] = -0.0643135388711;
   fEigenVectors_2[2][10][5] = -0.386291747477;
   fEigenVectors_2[2][10][6] = -0.110617929918;
   fEigenVectors_2[2][10][7] = 0.29490498042;
   fEigenVectors_2[2][10][8] = 0.358957541733;
   fEigenVectors_2[2][10][9] = 0.518242540106;
   fEigenVectors_2[2][10][10] = -0.00365049959076;
}

//_______________________________________________________________________
inline void ReadkMLP_pca_ce_600_n2_no_ev::Transform_2( std::vector<double>& iv, int cls ) const
{
   // PCA transformation
   const int nVar = 11;
   double *dv = new double[nVar];
   double *rv = new double[nVar];
   if (cls < 0 || cls > 2) {
       if (2 > 1 ) cls = 2;
       else cls = 2;
   }

   // define the indices of the variables which are transformed by this transformation
   static std::vector<int> indicesGet;
   static std::vector<int> indicesPut;

   if ( indicesGet.empty() ) { 
      indicesGet.reserve(fNvars);
      indicesGet.push_back( 0);
      indicesGet.push_back( 1);
      indicesGet.push_back( 2);
      indicesGet.push_back( 3);
      indicesGet.push_back( 4);
      indicesGet.push_back( 5);
      indicesGet.push_back( 6);
      indicesGet.push_back( 7);
      indicesGet.push_back( 8);
      indicesGet.push_back( 9);
      indicesGet.push_back( 10);
   } 
   if ( indicesPut.empty() ) { 
      indicesPut.reserve(fNvars);
      indicesPut.push_back( 0);
      indicesPut.push_back( 1);
      indicesPut.push_back( 2);
      indicesPut.push_back( 3);
      indicesPut.push_back( 4);
      indicesPut.push_back( 5);
      indicesPut.push_back( 6);
      indicesPut.push_back( 7);
      indicesPut.push_back( 8);
      indicesPut.push_back( 9);
      indicesPut.push_back( 10);
   } 

   for (int ivar=0; ivar<nVar; ivar++) dv[ivar] = iv[indicesGet.at(ivar)];

   // Perform PCA and put it into PCAed events tree
   this->X2P_2( dv, rv, cls );
   for (int ivar=0; ivar<nVar; ivar++) iv[indicesPut.at(ivar)] = rv[ivar];

   delete [] dv;
   delete [] rv;
}

//_______________________________________________________________________
inline void ReadkMLP_pca_ce_600_n2_no_ev::InitTransform()
{
   InitTransform_1();
   InitTransform_2();
}

//_______________________________________________________________________
inline void ReadkMLP_pca_ce_600_n2_no_ev::Transform( std::vector<double>& iv, int sigOrBgd ) const
{
   Transform_1( iv, sigOrBgd );
   Transform_2( iv, sigOrBgd );
}
